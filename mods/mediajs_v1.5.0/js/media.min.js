// media.js v1.5.0 Copyright (C) 2013-2018 Visman (mio.visman@yandex.ru)
if("undefined"===typeof FluxBB||!FluxBB)var FluxBB={};FluxBB.media=function(p,A,q){function w(h,k,f){var g,d="",b=n(h);if(b.canPlayType){for(g=0;g<k.length;g++)""!==b.canPlayType(h+"/"+f[g])&&(u[k[g]]=h+"/"+f[g],d+=(d?"|":"")+k[g]);return d?new RegExp("^([^\\\\\\?\\s<>\"'&]+\\.)("+d+")$","i"):!1}return!1}function n(h){return p.createElementNS?p.createElementNS("http://www.w3.org/1999/xhtml",h):p.createElement(h)}function v(h,b,f,g,d){if("string"!==typeof b)return h.appendChild(b);var k,a="video"==b||"audio"==b;f=f||{};g=g||{};b=n(b);for(var e in f)f.hasOwnProperty(e)&&("style"==e?b.style.cssText=f[e]:b.setAttribute(e,f[e]));a&&(k=n("source"));for(e in g)g.hasOwnProperty(e)&&(a?k.setAttribute(e,g[e]):(k=n("param"),k.setAttribute("name",e),k.setAttribute("value",g[e]),b.appendChild(k)));a&&b.appendChild(k);if(!d)return h.appendChild(b);f=h.parentNode;return(h=h.nextSibling)?f.insertBefore(b,h):f.appendChild(b)}function r(b){return 0===b%1&&9<b?2:"string"===typeof b&&/^(?:100|[1-9]\d(?:\.\d{1,2})?)%$/.test(b)?1:0}function b(b,k,f){if(k.i)var g="i";else if(k.v)g="v";else if(k.a)g="a";else{if(!B)return!1;g="o"}var d=k[g][0];k=k[g][1]?k[g][1]:{};if("i"==g){var h="iframe";d.frameborder="0";d.scrolling="no";d.allowfullscreen||(d.allowfullscreen="allowfullscreen")}else"v"==g?h="video":"a"==g?h="audio":(h="object",d.type="application/x-shockwave-flash",k.wmode="transparent");d.id="mediajs"+C++;f=f||{};f.wt=f.wt||640;f.ht=f.ht||360;var a=r(f.wt);var e=r(f.ht);if(1===a&&2===e)d.style="width:100%;height:"+f.ht+"px;",a={style:"padding-top:5px;overflow:hidden;position:relative;width:"+f.wt+";"},f={style:"height:"+f.ht+"px;overflow:hidden;position:relative;"};else if(0<a&&0<e)d.style="position:absolute;left:0;top:0;width:100%;height:100%;",a={style:"padding-top:5px;overflow:hidden;position:relative;"+(1===a?"width:"+f.wt+";":"max-width:"+f.wt+"px;")},f={style:"overflow:hidden;position:relative;height:0;padding-bottom:"+(1===e?f.ht:100*f.ht/f.wt+"%;")};else return!1;if(D&&"o"==g){h=g="";for(l in d)d.hasOwnProperty(l)&&("data"==l?k.movie=d[l]:"type"!=l&&(g+=" "+l+'="'+d[l]+'"'));for(l in k)k.hasOwnProperty(l)&&(h+='<param name="'+l+'" value="'+k[l]+'" />');var l=n("div");l.innerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+g+">"+h+"</object>";h=l.firstChild;l.removeChild(h)}v(v(v(b,"div",a,{},!0),"div",f),h,d,k);b.className+=(b.className?" ":"")+"mediajslink";return!0}function E(b){return/^\d+$/.test(b)?b:(b=b.match(/^((\d{1,2})h)?((\d{1,2})m)?((\d{1,2})s)?$/))?3600*(b[2]||0)+60*(b[4]||0)+1*(b[6]||0):""}var C=0,x="",u={},D=!!A.ActiveXObject,B=function(){if(q.plugins&&q.plugins.length&&q.mimeTypes&&q.mimeTypes["application/x-shockwave-flash"]&&q.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0;try{return new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),!0}catch(h){}return!1}(),y=w("audio","mp3 m4a ogg oga webma wav".split(" "),"mpeg mp4 ogg ogg webm wav".split(" ")),z=w("video",["mp4","m4v","ogv","webm","webmv"],["mp4","mp4","ogg","webm","webm"]);return{run:function(){var h;if((h=p.querySelectorAll("#brd-main .entry-content"))&&h.length)x=PUNBB.env.sva_mediajs.url_swf+"/";else if(!(h=p.querySelectorAll(".postmsg"))||!h.length)return;for(var k in h)if(h[k].className&&!(-1<(" "+h[k].className+" ").indexOf(" postsignature "))){var f=h[k].getElementsByTagName("a"),g;for(g in f)if(f[g].href&&(!f[g].nextSibling||f[g].nextSibling.tagName&&"BR"==f[g].nextSibling.tagName.toUpperCase())&&(!f[g].previousSibling||f[g].previousSibling.tagName&&"BR"==f[g].previousSibling.tagName.toUpperCase())&&"P"==f[g].parentNode.tagName.toUpperCase()&&!/<(p|a|img|ul|ol)/i.test(f[g].innerHTML)){for(var d=f[g].parentNode;d!==h[k]&&"BLOCKQUOTE"!==d.tagName.toUpperCase();)d=d.parentNode;if(d===h[k]){var q;d=void 0;var a,e=f[g],l=e.href;if(a=l.match(/^(.+)(?:#|%23)(\d+(?:\.\d{1,2})?)(%|%25)?(?::|%3A)(\d+(?:\.\d{1,2})?)(%|%25)?$/)){e.href=l=a[1];var m=a[2]+(a[3]?"%":"");var c=a[4]+(a[5]?"%":"");0<r(m)&&0<r(c)&&(d={wt:m,ht:c})}(a=l.split("re.php?u="))&&a[1]&&(l=decodeURIComponent(a[1]).replace(/(https?|ftp)___/g,"$1://"));l=l.replace(/&amp;/g,"&");if(m=l.match(/^(https?:\/\/)(www\.)?(.+)$/))if(c=m[3],m[4]="https:"==p.location.protocol?"https://":m[1],a=c.match(/^(?:[a-z\d-]+\.)?youtu(?:be(?:-nocookie)?\.com|\.be)\/(?:playlist|(?:(?:.*?[\?&]v=)?([\w-]{11})(?:\?|&|#|$)))/)){var n=["wmode=transparent","controls=2"],t=[];l="https://www.youtube.com/embed";a[1]?(l+="/"+a[1],m="start t end list rel loop".split(" ")):(n.push("listType=playlist"),m=["list","index","loop"],t=["list"]);for(q=c.split(/[\?&#]/);c=q.shift();)c=c.split("="),c[0]&&c[1]&&-1<m.indexOf(c[0])&&/^[\w-]+$/.test(c[1])&&("start"==c[0]||"t"==c[0]||"end"==c[0]?n.push(("end"==c[0]?"end":"start")+"="+E(c[1])):(n.push(c[0]+"="+c[1]),"loop"==c[0]&&"1"==c[1]&&a[1]&&n.push("playlist="+a[1])),c=t.indexOf(c[0]),-1<c&&t.splice(c,1));t.length||b(e,{i:[{src:l+"?"+n.join("&")}]},d)}else(a=c.match(/^(?:player\.)?vimeo\.com\/(?:video\/)?(\d+)/))?b(e,{i:[{src:m[4]+"player.vimeo.com/video/"+a[1]}]},d):(a=c.match(/^dai(?:lymotion\.com\/video|\.ly)\/([a-zA-Z\d]+)/))?b(e,{i:[{src:m[4]+"www.dailymotion.com/embed/video/"+a[1]+'?theme=none"'}]},d):(a=c.match(/^rutube\.ru\/tracks\/(?:\d+)\.html\?v=([a-zA-Z\d]+)/))?b(e,{o:[{data:m[4]+"video.rutube.ru/"+a[1]},{allowFullScreen:"true",allowScriptAccess:"always"}]},d):(a=c.match(/^(?:rutube\.ru\/video\/embed|video\.rutube\.ru)\/(\d+)/))?b(e,{i:[{src:m[4]+"rutube.ru/video/embed/"+a[1]}]},d):(a=c.match(/^rutube\.ru\/video\/([a-zA-Z\d]+)/))?b(e,{i:[{src:m[4]+"rutube.ru/video/embed/"+a[1]}]},d):(a=c.match(/^(?:m\.)?my\.mail\.ru\/(?!video\/)([\w-]+\/[\w\.-]+\/)video\/([\w\.-]+\/[\w-]+)(?:\.html)?/))?b(e,{i:[{src:"https://videoapi.my.mail.ru/videos/embed/"+a[1]+a[2]+".html"}]},d):(a=c.match(/^(?:video\.mail\.ru|my\.mail\.ru\/video\/.+#video=|my\.mail\.ru\/video)\/([\w-]+\/[\w\.-]+\/[\w\.-]+\/[\w-]+)(?:\.html)?/))?b(e,{i:[{src:"https://videoapi.my.mail.ru/videos/embed/"+a[1]+".html"}]},d):(a=c.match(/^smotri\.com\/video\/view\/\?id=([a-zA-Z\d]+)/))?b(e,{o:[{data:"http://pics.smotri.com/player.swf?file="+a[1]+"&bufferTime=3&autoStart=false&str_lang=rus"},{allowFullScreen:"true",allowScriptAccess:"always"}]},d):(a=c.match(/^(soundcloud\.com\/[\w-]+\/(sets\/)?[\w-]+|api\.soundcloud\.com\/(tracks|playlists)\/\d+)/))?b(e,{i:[{src:"https://w.soundcloud.com/player/?sharing=false&liking=false&show_playcount=false&show_comments=false&url="+l}]},d||{wt:"100%",ht:a[2]||"playlists"==a[3]?450:166}):(a=c.match(/^www(\d+)\.zippyshare\.com\/v(?:\/|.*?key=)(\d+)/))?b(e,{o:[{data:"http://www"+a[1]+".zippyshare.com/swf/player_local.swf?file="+a[2]+"&server="+a[1]+"&baseurl=http://www.zippyshare.com/api/&flashid=null&autostart=false&availablequality=both"},{allowScriptAccess:"always",allowFullScreen:"false"}]},d||{wt:"100%",ht:80}):(a=c.match(/^metacafe\.com\/(?:watch|embed)\/(\d+)/))?b(e,{i:[{src:"http://www.metacafe.com/embed/"+a[1]+"/"}]},d):(a=c.match(/^video\.sibnet\.ru\/[^\?&]*?video(\d+)/))?b(e,{i:[{src:m[4]+"video.sibnet.ru/shell.php?videoid="+a[1]+"/"}]},d):(a=c.match(/^promodj\.com\/(?:[^\/]+\/[^\/]+|download|embed)\/(\d+)/))?b(e,{i:[{src:m[4]+"promodj.com/embed/"+a[1]+"/big"}]},d||{wt:"100%",ht:70}):(a=c.match(/^(?:[a-z]{1,3}\.)?(ign\.com\/videos\/\d{4}\/\d{1,2}\/\d{1,2}\/[\w-]+)/))?b(e,{i:[{src:"http://widgets.ign.com/video/embed/content.html?url=http://www."+a[1]}]},d):(a=c.match(/^(?:[a-z]{1,3}\.)?twitch\.tv\/\w+\/v\/(\d+)/))?b(e,{i:[{src:"https://player.twitch.tv/?autoplay=false&video=v"+a[1]}]},d):(a=c.match(/^(?:[a-z]{1,3}\.)?twitch\.tv\/(?!(?:directory|login|store|jobs)\b)(\w+)$/))?b(e,{i:[{src:"https://player.twitch.tv/?autoplay=false&channel="+a[1]}]},d):(a=c.match(/^g4tv\.com\/(?:videos|lv3)\/(\d+)/))?b(e,{o:[{data:"http://www.g4tv.com/lv3/"+a[1]},{allowFullScreen:"true",allowScriptAccess:"always"}]},d):(a=c.match(/^([a-z]{1,}\.)?gamespot\.com\/(?:video(?:s|embed)?|[\w\/-]+\/videos?)(?=\/)[^\?&#]*[\/-](\d{7,})\//))?(c=c.split("?"),c=c[1]?c[1].replace(/&?autoplay=[^&]*/g,"").replace(/^&/,""):!1,b(e,{i:[{src:"https://www.gamespot.com/videos/embed/"+a[2]+"/"+(c?"?"+c:"")}]},d)):y&&(a=c.match(y))?b(e,{a:[{controls:!0,preload:"metadata"},{src:m[1]+(m[2]?m[2]:"")+a[1]+a[2],type:u[a[2]]}]},d||{wt:"100%",ht:50}):z&&(a=c.match(z))?b(e,{v:[{controls:!0,preload:"metadata"},{src:m[1]+(m[2]?m[2]:"")+a[1]+a[2],type:u[a[2]]}]},d):c.match(/^([^\\\?\s<>"'&]+\.mp3)$/)?b(e,{o:[{data:x+"swf/mp3player.swf"},{FlashVars:"soundFile="+l,quality:"high",menu:"false"}]},{wt:"100%",ht:24}):(a=c.match(/^hu(?:\.lk\/|lkshare\.com\/(?:.*?fn=)?)([a-z\d]{12})(?:$|[^a-z\d])/))?b(e,{i:[{src:"http://www.hulkshare.com/embed.php?fn="+a[1]}]},d||{wt:"100%",ht:160}):(a=c.match(/^(mixcloud\.com\/(?!(categories|competitions|projects|developers|tag)\/)[\w-]+\/(?!(listens|favorites|activity|messages|following)\/)[\w-]+\/)$/))?b(e,{i:[{src:m[4]+"www.mixcloud.com/widget/iframe/?hide_artwork=1&embed_type=widget_standard&hide_tracklist=1&feed=http://www."+a[1]}]},d||{wt:"100%",ht:120}):(a=c.match(/^(vk\.com\/video_ext\.php\?oid=[\d-]+&id=[\d-]+&hash=\w+(&sd|&hd=1|&hd=2)?)/))?b(e,{i:[{src:m[4]+a[1]}]},d):(a=c.match(/^coub\.com\/view\/([a-zA-Z\d]+)/))?b(e,{i:[{src:"http://coub.com/embed/"+a[1]+"?muted=false"}]},d):(a=c.match(/^vine\.co\/v\/([a-zA-Z\d]+)/))?b(e,{i:[{src:"https://vine.co/v/"+a[1]+"/embed/simple"}]},d||{wt:360,ht:360}):(a=c.match(/^(?:[a-z\d-]+\.)?facebook\.com.*?\/(?:photo\.php|video\.php|embed|videos\/(?:vb\.\d+\/)?)(?:.*?[\?&]v(?:ideo_id)?=)?(\d+)(?=\/|&|$)/))?b(e,{i:[{src:"https://www.facebook.com/video/embed?video_id="+a[1]}]},d):(a=c.match(/^(?=[^\/]*\byandex\.(com|ru|ua)\/)(?=[^\?&]*\bmaps\b).+\/\-\/([\w~\-]+)$/))?b(e,{i:[{src:"https://api-maps.yandex."+a[1]+"/frame/v1/-/"+a[2]}]},d||{wt:410,ht:350}):(a=c.match(/^maps\.google\.((?:com?\.)?[a-z]{2,3})\/([a-z\d\?\.,&=]+)$/))?b(e,{i:[{src:("cn"==a[1]?"http://maps.google."+a[1]:"https://maps.google.com")+"/"+a[2]+"&ie=UTF8&output=embed"}]},d||{wt:410,ht:350}):(a=c.match(/^google\.((?:com?\.)?[a-z]{2,3})\/maps\/embed\?pb=([^\s\?<>,&]+)$/))?b(e,{i:[{src:("cn"==a[1]?"http://www.google."+a[1]:"https://www.google.com")+"/maps/embed?pb="+a[2]}]},d||{wt:410,ht:350}):(a=c.match(/^google\.((?:com?\.)?[a-z]{2,3})\/maps\/(?:place\/([^\/<>\[\]\?&]+))?[^\?&]*@(-?\d+\.\d+),(-?\d+\.\d+),(\d+(?:\.\d+)?)([zm])/))?(l=("cn"==a[1]?"http://maps.google."+a[1]:"https://maps.google.com")+"/?ll="+a[3]+","+a[4]+"&t="+("z"==a[6]?"m":"h")+"&z=",m=a[5],"z"!=a[6]&&(m=Math.log(704E5/m)/Math.log(2)),b(e,{i:[{src:l+Math.min(18,Math.max(Math.round(m),3))+(a[2]?"&q="+a[2]:"")+"&ie=UTF8&output=embed"}]},d||{wt:410,ht:350})):(a=c.match(/^ok\.ru\/video(?:embed)?\/(\d+)/))?b(e,{i:[{src:"https://ok.ru/videoembed/"+a[1]}]},d):(a=c.match(/^liveleak\.com\/(?:view|ll_embed)\?i=(\w+)/))?b(e,{i:[{src:"http://www.liveleak.com/ll_embed?i="+a[1]}]},d):(a=c.match(/^video\.online\.ua\/(?:embed\/)?(\d+)\//))?b(e,{i:[{src:m[4]+"video.online.ua/embed/"+a[1]+"/"}]},d):(a=c.match(/^aparat\.com\/(?:v|embed)\/(\w+)/))&&b(e,{i:[{src:"https://www.aparat.com/video/video/embed/videohash/"+a[1]+"/vt/frame"}]},d)}}}},init:function(){p.addEventListener&&p.addEventListener("DOMContentLoaded",FluxBB.media.run(),!1)}}}(document,window,navigator);FluxBB.media.init();